name: Continuous Integration
on: push

jobs:
  ci:
    name: CI
    uses: acidicoala/KoalaBox/.github/workflows/build-and-package.yml@098089a96d42aa31c8aa3c53438c7a070e7828f4
    permissions:
      contents: write
    with:
      arch: '[ 32, 64 ]'
      config: Release
      modules: >-
        [
          "audioses",
          "d3d9",
          "d3d10",
          "d3d11",
          "dinput8",
          "dwmapi",
          "dxgi",
          "glu32",
          "hid",
          "iphlpapi",
          "msasn1",
          "msimg32",
          "mswsock",
          "opengl32",
          "profapi",
          "propsys",
          "textshaping",
          "version",
          "winhttp",
          "wldp",
          "winmm",
          "xinput9_1_0"
        ]

      zip_command: >
        cp res/Koaloader.config.json artifacts/Koaloader.config.json &&
        cd artifacts &&
        zip ../$ZIP_NAME ./* -r
